{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDAL-LANG</title>
        <link rel="stylesheet" href="{% static 'css/OwnerStoreRegistration.css'%}" />

</head>
<body>
    <main>
        <div id="container">
            <header>
                <a href="{% url 'stores:owner-store-list' %}">
                    <img src="{% static 'img/leftside.svg'%}" class="sideClick"/>
                </a>
                <p id="title">챌린지 수정</p>
                <p></p>
            </header>
            <div id="containerBox">
                <form method="post">
                    {% csrf_token %}
            
                    <!-- 제목 -->
                    <input type="text" name="title" id="id_title"
                           placeholder="챌린지 제목" class="inputBox"
                           value="{{ form.title.value|default_if_none:'' }}"/>
                    
                    <!-- 설명 -->
                    <textarea  name="description" id="id_description"
                              placeholder="챌린지 설명"
                              style="resize:none;"
                              class="inputBox" rows="3">{{ form.description.value|default_if_none:'' }}</textarea>

                    <!--################ 보상 ################-->
                    <div class="box">
                        <p class="boxTitle">보상 종류</p>
                        <select name="reward_type" id="id_reward_type" class="timeStyle">
                            <option value="">-- 선택하세요 --</option>
                            {% for choice in form.fields.reward_type.choices %}
                                <option value="{{ choice.0 }}"
                                    {% if form.reward_type.value == choice.0 %}selected{% endif %}>
                                    {{ choice.1 }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- 포인트 보상 -->
                    <div id="reward-points-field">
                        <input type="number" name="reward_points" id="id_reward_points"
                               placeholder="포인트 보상" class="inputBox"
                               value="{{ form.reward_points.value|default_if_none:'' }}"/>
                    </div>

                    <!-- 직접 입력 보상 -->
                    <div id="reward-custom-field">
                        <input type="text" name="reward_description" id="id_reward_description"
                               placeholder="직접 입력 보상" class="inputBox"
                               value="{{ form.reward_description.value|default_if_none:'' }}"/>
                    </div>
                    <!--####################################-->

                    <div class="box">
                        <p class="boxTitle">미션 종류</p>
                        <select name="mission_type" id="id_mission_type" class="timeStyle">
                            <option value="">-- 선택하세요 --</option>
                            {% for choice in form.fields.mission_type.choices %}
                                <option value="{{ choice.0 }}"
                                    {% if form.mission_type.value == choice.0 %}selected{% endif %}>
                                    {{ choice.1 }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- 목표치 -->
                    <input type="number" name="target_value" id="id_target_value"
                           placeholder="목표치" class="inputBox"
                           value="{{ form.target_value.value|default_if_none:'' }}"/>

                    <!-- 시작일 -->
                    <div class="box">
                        <p class="boxTitle">시작일</p>
                        <input type="datetime-local" name="start_date" id="id_start_date"
                               class="timeStyle"
                               value="{{ form.start_date.value|date:'Y-m-d\\TH:i' }}"/>
                    </div>

                    <!-- 종료일 -->
                    <div class="box">
                        <p class="boxTitle">종료일</p>
                        <input type="datetime-local" name="end_date" id="id_end_date"
                               class="timeStyle"
                               value="{{ form.end_date.value|date:'Y-m-d\\TH:i' }}"/>
                    </div>

                    <button type="submit" class="btn" id="btn">완료</button>
                </form>
            </div>
        </div>
    </main>

    <!--################ JS(보상 관련) ################-->
    <script>
    const rewardSelect = document.getElementById("id_reward_type");
    const pointsField = document.getElementById("reward-points-field");
    const customField = document.getElementById("reward-custom-field");

    function toggleRewardFields() {
        if (rewardSelect.value === "POINT") {
            pointsField.style.display = "block";
            customField.style.display = "none";
        } else {
            pointsField.style.display = "none";
            customField.style.display = "block";
        }
    }

    rewardSelect.addEventListener("change", toggleRewardFields);
    toggleRewardFields();
    </script>
</body>
</html>
